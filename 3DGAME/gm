using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.SceneManagement;


public class GameManager : MonoBehaviour
{
    public static GameManager Instance { get; private set; }
    
    private int[] ammo = {20, 0};
    private int[] clip;
    private int hp; 
    private string sceneName; 
    private int points; 
    
    //Tendre que hacerlo asi pero de momento uso hardcode
    //private int[] max = new int{100, 50, 100};
    private bool star;
    

    private void Awake()
    {
        star = false; 
        if (Instance == null)
        {
            Instance = this;
            DontDestroyOnLoad(gameObject);
            Debug.Log("GameManager creado"); 
        }
        else
        {
            Debug.Log("Demasiados GameManager");
        }
    }

    void Update()
    {
        if(Input.GetKeyDown(KeyCode.G)){
            star = !star; 
            if(star)Debug.Log("Godmode ON");
            else Debug.Log("Godmode OFF"); 
        }
        else if (Input.GetKeyDown(KeyCode.M)){
            ammo[0] = 100; 
            ammo[1] = 40; 
            Debug.Log("Max ammo! SMG: " + ammo[0] + ", shotty: " + ammo[1] + ".");
        }
        else if (Input.GetKey(KeyCode.Keypad1)){
            loadScene("Inicio");
        }
        else if (Input.GetKey(KeyCode.Keypad2)){
            loadScene("Instrucciones");
        }
        else if (Input.GetKey(KeyCode.Keypad3)){
            loadScene("Creditos"); 
        }
    }

    public void loadScene(string a){
        SceneManager.LoadScene(a); 
    }

    public void restartLevel()
    {
        SceneManager.LoadScene(SceneManager.GetActiveScene().name);
    }


    public int getClip(int a){
      if(a>1) return -1; 
      else return clip[a]; 

    }
    

    //Funcion que se llama cada vez que dispara el arma 
    public void shoot(int weapon){
      clip[weapon]--; 
    }

    public void takeDamage(int amount){
        hp = hp - amount;
        //if(hp < 0) lose  

    }

    public void gainHealth(int amount){
        hp = hp + amount; 
        if(hp>100) hp = 100; 
    }

    public void reloadGun(int weapon){//talvez optimizar para no duplicar tanto code pero icba
    
        if(weapon == 1){
            if(clip[0] == 25)return; 
            else{
                int bulletsAdded = 25 - clip[0];
                if(bulletsAdded > ammo[0]){
                    clip[0] += ammo[0]; 
                    ammo[0] = 0; 
                    return; 
                } 
                else{
                    clip[0] += bulletsAdded; 
                    ammo[0] -= bulletsAdded; 
                    return;
                }
            }
        }
        else{
            if(clip[1] == 10)return; 
            else{
                int bulletsAdded = 10 - clip[1];
                if(bulletsAdded > ammo[1]){
                    clip[1] += ammo[1]; 
                    ammo[1] = 0; 
                    return; 
                } 
                else{
                    clip[1] += bulletsAdded; 
                    ammo[1] -= bulletsAdded; 
                    return;
                }
            }

        }
    }

    public void addPoints(int amount){
        points += amount; 
    }

    public void addLootChest(string cosa, int amount){//TALVEZ hay que cambiar estos para tener en cuenta los buffs a 
        if(cosa == "A1"){
            ammo[0] += amount; 
            if(ammo[0] > 100) ammo[0] = 100; 
        }
        else if(cosa == "A2"){
            ammo[1] += amount; 
            if(ammo[1] > 40) ammo[1] = 50; 
        }
        else if(cosa == "HP"){
            hp += amount; 
            if(hp > 100) hp = 100; 
        }
    }
}
